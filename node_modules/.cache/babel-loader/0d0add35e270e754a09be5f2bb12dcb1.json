{"ast":null,"code":"import _classCallCheck from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _toConsumableArray from \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nvar _jsxFileName = \"/Users/itaycohen/Documents/GitHub/the-books-of-medium/src/App.js\";\nimport React, { Component } from 'react';\nimport { compose } from 'recompose';\nimport BookList from './components/bookList/BookList'; // import logo from './logo.svg';\n\nimport './App.css'; // import { Button } from 'semantic-ui-react'\n// import { Image as ImageComponent, Item } from 'semantic-ui-react'\n// const paragraph = <ImageComponent src={require('/Users/itaycohen/Documents/GitHub/the-books-of-medium/src/images/short-paragraph.png')} />\n\nvar applyUpdateResult = function applyUpdateResult(result) {\n  return function (prevState) {\n    return {\n      docs: _toConsumableArray(prevState.docs).concat(_toConsumableArray(result.docs)),\n      page: result.page,\n      isLoading: false\n    };\n  };\n};\n\nvar applySetResult = function applySetResult(result) {\n  return function (prevState) {\n    return {\n      docs: result.docs,\n      page: result.page,\n      isLoading: false\n    };\n  };\n};\n\nvar getBooks = function getBooks(page) {\n  return \"https://thebooksofmedium-api.herokuapp.com/books/ppp?page=\".concat(page + 1);\n};\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.onInitialSearch = function (e) {\n      // e.preventDefault();\n      // const { value } = this.input;\n      // if (value === '') {\n      //   return;\n      // }\n      // this.fetchStories(value, 0);\n      _this.fetchStories(0);\n    };\n\n    _this.onPaginatedSearch = function (e) {\n      return _this.fetchStories(_this.state.page + 1);\n    };\n\n    _this.fetchStories = function (page) {\n      _this.setState({\n        isLoading: true\n      });\n\n      fetch(getBooks(page)).then(function (response) {\n        return response.json();\n      }).then(function (result) {\n        _this.onSetResult(result, page);\n\n        console.log(\"docs:\", result.docs);\n      });\n    };\n\n    _this.onSetResult = function (result, page) {\n      return page === 0 ? _this.setState(applySetResult(result)) : _this.setState(applyUpdateResult(result));\n    };\n\n    _this.state = {\n      docs: [],\n      page: null,\n      isLoading: false\n    };\n    console.log(\"constructor\");\n\n    _this.fetchStories(\"a\", 0);\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(ListWithLoadingWithInfinite, {\n        list: this.state.docs,\n        isLoading: this.state.isLoading,\n        page: this.state.page,\n        onPaginatedSearch: this.onPaginatedSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nvar withLoading = function withLoading(Component) {\n  return function (props) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(Component, Object.assign({}, props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"interactions\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, props.isLoading && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Loading...\")));\n  };\n};\n\nvar withInfiniteScroll = function withInfiniteScroll(Component) {\n  return (\n    /*#__PURE__*/\n    function (_React$Component) {\n      _inherits(WithInfiniteScroll, _React$Component);\n\n      function WithInfiniteScroll() {\n        var _getPrototypeOf2;\n\n        var _this2;\n\n        _classCallCheck(this, WithInfiniteScroll);\n\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(WithInfiniteScroll)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n        _this2.onScroll = function () {\n          if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500 && _this2.props.list.length && !_this2.props.isLoading) {\n            _this2.props.onPaginatedSearch();\n          }\n        };\n\n        return _this2;\n      }\n\n      _createClass(WithInfiniteScroll, [{\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n          window.addEventListener('scroll', this.onScroll, false);\n        }\n      }, {\n        key: \"componentWillUnmount\",\n        value: function componentWillUnmount() {\n          window.removeEventListener('scroll', this.onScroll, false);\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          return React.createElement(Component, Object.assign({}, this.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 133\n            },\n            __self: this\n          }));\n        }\n      }]);\n\n      return WithInfiniteScroll;\n    }(React.Component)\n  );\n}; // const List = ({ list }) =>\n// <div className=\"list\">\n//   {list.map(item => <div className=\"list-row\" key={item._id}>\n//     <a href={item.amazonLink}>{item.bookName}</a>\n//   </div>)}\n// </div>\n\n\nvar List = function List(_ref) {\n  var list = _ref.list;\n  return React.createElement(Item.Group, {\n    divided: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, sortedByScoreBookList.map(function (bookObject, index) {\n    return React.createElement(BookItem, {\n      id: bookObject.id,\n      bookName: bookObject.bookName,\n      bookAuthor: bookObject.bookAuthor,\n      amazonLink: bookObject.amazonLink,\n      bookCoverImg: bookObject.bookCoverImg,\n      totalMentionsClaps: bookObject.totalMentionsClaps,\n      numberOfMentions: bookObject.numberOfMentions,\n      score: bookObject.score,\n      index: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    });\n  }));\n};\n\nvar ListWithLoadingWithInfinite = compose(withInfiniteScroll, withLoading)(List);\nexport default App;","map":{"version":3,"sources":["/Users/itaycohen/Documents/GitHub/the-books-of-medium/src/App.js"],"names":["React","Component","compose","BookList","applyUpdateResult","result","prevState","docs","page","isLoading","applySetResult","getBooks","App","props","onInitialSearch","e","fetchStories","onPaginatedSearch","state","setState","fetch","then","response","json","onSetResult","console","log","withLoading","withInfiniteScroll","onScroll","window","innerHeight","scrollY","document","body","offsetHeight","list","length","addEventListener","removeEventListener","List","sortedByScoreBookList","map","bookObject","index","id","bookName","bookAuthor","amazonLink","bookCoverImg","totalMentionsClaps","numberOfMentions","score","ListWithLoadingWithInfinite"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { compose } from 'recompose';\n\nimport BookList from './components/bookList/BookList';\n// import logo from './logo.svg';\nimport './App.css';\n// import { Button } from 'semantic-ui-react'\n// import { Image as ImageComponent, Item } from 'semantic-ui-react'\n\n// const paragraph = <ImageComponent src={require('/Users/itaycohen/Documents/GitHub/the-books-of-medium/src/images/short-paragraph.png')} />\n\n\nconst applyUpdateResult = (result) => (prevState) => ({\n  docs: [...prevState.docs, ...result.docs],\n  page: result.page,\n  isLoading: false,\n});\n\nconst applySetResult = (result) => (prevState) => ({\n  docs: result.docs,\n  page: result.page,\n  isLoading: false,\n});\n\n\nconst getBooks = (page) => `https://thebooksofmedium-api.herokuapp.com/books/ppp?page=${page + 1}`;\n\n\n\n\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      docs: [],\n      page: null,\n      isLoading: false,\n    };\n    console.log(\"constructor\")\n    this.fetchStories(\"a\", 0);\n\n  }\n\n\n  onInitialSearch = (e) => {\n    // e.preventDefault();\n\n    // const { value } = this.input;\n\n    // if (value === '') {\n    //   return;\n    // }\n\n    // this.fetchStories(value, 0);\n\n    this.fetchStories(0);\n  }\n\n\n  onPaginatedSearch = (e) => this.fetchStories(this.state.page + 1);\n\n  fetchStories = (page) => {\n    this.setState({ isLoading: true });\n    fetch(getBooks(page))\n      .then(response => response.json())\n      .then(result => {\n        this.onSetResult(result, page)\n        console.log(\"docs:\", result.docs)\n      }\n      );\n\n  }\n\n  onSetResult = (result, page) =>\n    page === 0\n      ? this.setState(applySetResult(result))\n      : this.setState(applyUpdateResult(result));\n\n  render() {\n    return (\n      <div className=\"App\">\n        {/* <BookList /> */}\n\n\n        <ListWithLoadingWithInfinite\n          list={this.state.docs}\n          isLoading={this.state.isLoading}\n          page={this.state.page}\n          onPaginatedSearch={this.onPaginatedSearch}\n        />\n      </div>\n\n\n    );\n  }\n}\n\nconst withLoading = (Component) => (props) =>\n  <div>\n    <Component {...props} />\n\n    <div className=\"interactions\">\n      {props.isLoading && <span>Loading...</span>}\n    </div>\n  </div>\n\n\n\nconst withInfiniteScroll = (Component) =>\n  class WithInfiniteScroll extends React.Component {\n    componentDidMount() {\n      window.addEventListener('scroll', this.onScroll, false);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('scroll', this.onScroll, false);\n    }\n\n    onScroll = () => {\n      if (\n        (window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 500) &&\n        this.props.list.length &&\n        !this.props.isLoading\n      ) {\n        this.props.onPaginatedSearch();\n      }\n    }\n\n    render() {\n      return <Component {...this.props} />;\n    }\n  }\n\n\n\n// const List = ({ list }) =>\n// <div className=\"list\">\n//   {list.map(item => <div className=\"list-row\" key={item._id}>\n//     <a href={item.amazonLink}>{item.bookName}</a>\n//   </div>)}\n// </div>\n\n\nconst List = ({ list }) =>\n\n  <Item.Group divided>\n    {\n      sortedByScoreBookList.map((bookObject, index) => {\n        return (\n          <BookItem\n            id={bookObject.id}\n            bookName={bookObject.bookName}\n            bookAuthor={bookObject.bookAuthor}\n            amazonLink={bookObject.amazonLink}\n            bookCoverImg={bookObject.bookCoverImg}\n            totalMentionsClaps={bookObject.totalMentionsClaps}\n            numberOfMentions={bookObject.numberOfMentions}\n            score={bookObject.score}\n            index={index}\n          />\n        );\n      })\n    }\n  </Item.Group>\n\n\n\n\n\n\n\nconst ListWithLoadingWithInfinite = compose(\n  withInfiniteScroll,\n  withLoading,\n)(List);\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}